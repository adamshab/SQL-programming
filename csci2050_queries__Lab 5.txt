-- Collection: Lab 5
-- Created by: adamshab

-- ==================================

-- Query: 
SELECT o.ORDER_ID
FROM `ORDER` o
JOIN CUSTOMER c ON o.CUSTOMER_ID = c.CUSTOMER_ID
WHERE DATE(o.ORDER_DATE) = '2021-08-03'
AND o.SHIP_DATE IS NULL
AND c.name = 'Rex Tooling Inc'
ORDER BY o.ORDER_ID;

-- Run at 2024-02-09 21:13:36
-- 

-- 31 Results:
-- +----------+
-- | ORDER_ID |
-- +----------+
-- |    88002 |
-- +----------+
-- |    88002 |
-- +----------+
-- |    88002 |
-- +----------+
-- |    88002 |
-- +----------+
-- |    88002 |
-- +----------+
-- |    88002 |
-- +----------+
-- |    88010 |
-- +----------+
-- |    88010 |
-- +----------+
-- |    88010 |
-- +----------+
-- |    88010 |
-- +----------+
-- |    88010 |
-- +----------+
-- |    88010 |
-- +----------+
-- |    88021 |
-- +----------+
-- |    88021 |
-- +----------+
-- |    88021 |
-- +----------+
-- |    88021 |
-- +----------+
-- |    88021 |
-- +----------+
-- |    88021 |
-- +----------+
-- |    88064 |
-- +----------+
-- |    88064 |
-- +----------+
-- |    88068 |
-- +----------+
-- |    88068 |
-- +----------+
-- |    88068 |
-- +----------+
-- |    88119 |
-- +----------+
-- |    88119 |
-- +----------+
-- |    88119 |
-- +----------+
-- |    88126 |
-- +----------+
-- |    88126 |
-- +----------+
-- |    88126 |
-- +----------+
-- |    88126 |
-- +----------+
-- |    88126 |
-- +----------+

-- ==================================

-- Query: 
SELECT 
    o.ORDER_ID,
    c.NAME AS Customer_Name,
    p.DESCRIPTION AS Product_Description,
    o.ORDER_DATE,
    o.SHIP_DATE,
    o.ORDER_QTY,
    p.PRICE AS Product_Price
FROM 
    `ORDER` o
JOIN 
    CUSTOMER c ON o.CUSTOMER_ID = c.CUSTOMER_ID
JOIN 
    PRODUCT p ON o.PRODUCT_ID = p.PRODUCT_ID
WHERE 
    o.ORDER_DATE < '2020-02-01'
    AND o.SHIP_DATE IS NOT NULL
    AND o.ORDER_QTY > 1990
    AND p.PRICE > 14.50
ORDER BY 
    o.ORDER_DATE;

-- Run at 2024-02-09 21:16:07
-- 

-- 10 Results:
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- | ORDER_ID |      Customer_Name     | Product_Description | ORDER_DATE |  SHIP_DATE | ORDER_QTY | Product_Price |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |      215 | Marsh Lane Metal Works |              Silver | 2020-01-02 | 2020-01-07 |      1995 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |      420 |  Re-Barre Construction |              Silver | 2020-01-03 | 2020-01-08 |      1999 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |      363 |   Prairie Construction |              Silver | 2020-01-03 | 2020-01-05 |      1998 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |      330 |  Re-Barre Construction |              Silver | 2020-01-03 | 2020-01-05 |      1998 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |     1043 |        Rex Tooling Inc |              Silver | 2020-01-07 | 2020-01-08 |      1996 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |     1387 | Marsh Lane Metal Works |              Silver | 2020-01-10 | 2020-01-12 |      1999 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |     2493 |  Re-Barre Construction |              Silver | 2020-01-17 | 2020-01-22 |      1994 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |     2829 |   Prairie Construction |              Silver | 2020-01-19 | 2020-01-21 |      1997 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |     3769 |        Rex Tooling Inc |              Silver | 2020-01-25 | 2020-01-30 |      1998 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+
-- |     3933 |        Rex Tooling Inc |              Silver | 2020-01-26 | 2020-01-28 |      1998 |         15.00 |
-- +----------+------------------------+---------------------+------------+------------+-----------+---------------+

-- ==================================

-- Query: 
SELECT 
    o.PRODUCT_ID,
    p.DESCRIPTION,
    SUM(o.ORDER_QTY) AS OUTSTANDING_QTY
FROM 
    `ORDER` o
JOIN 
    CUSTOMER c ON o.CUSTOMER_ID = c.CUSTOMER_ID
JOIN 
    PRODUCT p ON o.PRODUCT_ID = p.PRODUCT_ID
WHERE 
    c.STATE = 'TX'
    AND o.SHIP_DATE IS NULL
GROUP BY 
    o.PRODUCT_ID, p.DESCRIPTION
ORDER BY 
    o.PRODUCT_ID;

-- Run at 2024-02-09 21:19:57
-- 

-- 9 Results:
-- +------------+-------------+-----------------+
-- | PRODUCT_ID | DESCRIPTION | OUTSTANDING_QTY |
-- +------------+-------------+-----------------+
-- |          1 |      Copper |         4373288 |
-- +------------+-------------+-----------------+
-- |          2 |    Aluminum |         4316736 |
-- +------------+-------------+-----------------+
-- |          3 |      Silver |         4154037 |
-- +------------+-------------+-----------------+
-- |          4 |       Steel |         4254164 |
-- +------------+-------------+-----------------+
-- |          5 |      Bronze |         4346285 |
-- +------------+-------------+-----------------+
-- |          6 |   Duralumin |         4326144 |
-- +------------+-------------+-----------------+
-- |          7 |      Solder |         4329488 |
-- +------------+-------------+-----------------+
-- |          8 |    Stellite |         4315223 |
-- +------------+-------------+-----------------+
-- |          9 |       Brass |         4325734 |
-- +------------+-------------+-----------------+

-- ==================================

-- Query: 
SELECT 
    c.NAME AS Customer_Name,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Copper' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Copper,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Aluminum' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Aluminum,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Silver' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Silver,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Steel' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Steel,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Bronze' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Bronze,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Duralumin' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Duralumin,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Solder' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Solder,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Stellite' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Stellite,
    ROUND(SUM(CASE WHEN p.DESCRIPTION = 'Brass' THEN o.ORDER_QTY ELSE 0 END) / 1000000, 2) AS Brass,
    ROUND(SUM(o.ORDER_QTY * p.PRICE) / 1000000, 2) AS Market_Value
FROM 
    `ORDER` o
JOIN 
    CUSTOMER c ON o.CUSTOMER_ID = c.CUSTOMER_ID
JOIN 
    PRODUCT p ON o.PRODUCT_ID = p.PRODUCT_ID
WHERE 
    o.SHIP_DATE IS NULL
GROUP BY 
    c.NAME
ORDER BY 
    Customer_Name;

-- Run at 2024-02-09 21:24:15
-- 

-- 5 Results:
-- +------------------------+--------+----------+--------+-------+--------+-----------+--------+----------+-------+--------------+
-- |      Customer_Name     | Copper | Aluminum | Silver | Steel | Bronze | Duralumin | Solder | Stellite | Brass | Market_Value |
-- +------------------------+--------+----------+--------+-------+--------+-----------+--------+----------+-------+--------------+
-- |        LITE Industrial |   1.46 |     1.46 |   1.38 |  1.42 |   1.49 |      1.42 |   1.38 |     1.44 |  1.49 |       115.60 |
-- +------------------------+--------+----------+--------+-------+--------+-----------+--------+----------+-------+--------------+
-- | Marsh Lane Metal Works |   1.51 |     1.46 |   1.43 |  1.40 |   1.44 |      1.39 |   1.44 |     1.43 |  1.47 |       116.51 |
-- +------------------------+--------+----------+--------+-------+--------+-----------+--------+----------+-------+--------------+
-- |   Prairie Construction |   1.35 |     1.36 |   1.36 |  1.39 |   1.37 |      1.43 |   1.38 |     1.40 |  1.37 |       112.25 |
-- +------------------------+--------+----------+--------+-------+--------+-----------+--------+----------+-------+--------------+
-- |  Re-Barre Construction |   1.42 |     1.44 |   1.37 |  1.40 |   1.39 |      1.44 |   1.47 |     1.44 |  1.38 |       115.10 |
-- +------------------------+--------+----------+--------+-------+--------+-----------+--------+----------+-------+--------------+
-- |        Rex Tooling Inc |   1.49 |     1.42 |   1.40 |  1.43 |   1.47 |      1.46 |   1.48 |     1.44 |  1.46 |       117.51 |
-- +------------------------+--------+----------+--------+-------+--------+-----------+--------+----------+-------+--------------+

-- ==================================

